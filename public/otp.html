<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Email Verification</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: url("https://www.avatier.com/_next/image/?url=https%3A%2F%2Fhl.avatier.com%2Fwp-content%2Fuploads%2F2025%2F04%2FAvatier-and-Security-Online.jpg&w=1920&q=75") center/cover;
            font-family: Poppins, sans-serif;
        }

        .card {
            background: #eee;
            width: 360px;
            padding: 40px;
            border-radius: 16px;
            text-align: center;
            animation: fade 1s;
        }

        @keyframes fade {
            from {
                opacity: 0;
                transform: translateY(30px)
            }

            to {
                opacity: 1
            }
        }

        input,
        button {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            border-radius: 8px;
            border: none;
        }

        button {
            background: #667eea;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
        }

        button:disabled {
            background: green
        }

        .otp-box {
            display: none
        }

        .status {
            margin-top: 10px
        }
    </style>
</head>

<body>
    <div class="card">
        <h2>Email Verification</h2>
        <div id="email"></div>
        <button id="sendBtn">Send OTP</button>

        <div class="otp-box" id="otpBox">
            <input id="otp" placeholder="Enter OTP" maxlength="6">
            <button id="verifyBtn">Verify</button>
        </div>

        <div class="status" id="status"></div>
    </div>

    <script>
        const API_BASE = "https://YOUR-BACKEND-URL.onrender.com"; // ðŸ”¥ CHANGE

        const params = new URLSearchParams(location.search);
        const email = params.get("email");
        const name = params.get("name") || "User";

        document.getElementById("email").innerText = email;

        const sendBtn = document.getElementById("sendBtn");
        const otpBox = document.getElementById("otpBox");
        const status = document.getElementById("status");

        sendBtn.onclick = () => {
            sendBtn.disabled = true;
            sendBtn.innerText = "Sending OTP...";

            fetch(`${API_BASE}/send-otp`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email, name })
            })
                .then(r => r.json())
                .then(() => {
                    sendBtn.innerText = "OTP Sent âœ…";
                    otpBox.style.display = "block";
                    status.style.color = "green";
                    status.innerText = "Check your email";
                })
                .catch(() => {
                    sendBtn.disabled = false;
                    sendBtn.innerText = "Send OTP";
                    status.style.color = "red";
                    status.innerText = "Failed to send OTP";
                });
        };

        document.getElementById("verifyBtn").onclick = () => {
            const otp = document.getElementById("otp").value;

            fetch(`${API_BASE}/verify-otp`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email, otp })
            })
                .then(r => r.json())
                .then(data => {
                    status.innerText = data.message;
                    status.style.color = data.message.includes("success") ? "green" : "red";
                    if (data.message.includes("success")) {
                        alert("OTP Verified ðŸŽ‰");
                    }
                });
        };
    </script>
</body>

</html>